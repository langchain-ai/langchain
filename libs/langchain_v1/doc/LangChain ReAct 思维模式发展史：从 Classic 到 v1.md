

# LangChain ReAct æ€ç»´æ¨¡å¼å‘å±•å²ï¼šä» Classic åˆ° v1 ï¼ˆagentå‘å±•å†å²ï¼‰

## ä¸€ã€æŠ€æœ¯å‘å±•è„‰ç»œ

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                      â•‘
â•‘                        LangChain Agent æŠ€æœ¯å‘å±•å²                                     â•‘
â•‘                                                                                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                                      â•‘
â•‘   é˜¶æ®µ 1ï¼šLangChain Classic (langchain_classic.agents)                               â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   ç‰¹ç‚¹ï¼š                                                                    â”‚     â•‘
â•‘   â”‚   - åŸºäº PromptTemplate + OutputParser                                     â”‚     â•‘
â•‘   â”‚   - ä½¿ç”¨ intermediate_steps ç»´æŠ¤ç»“æ„åŒ–çŠ¶æ€                                  â”‚     â•‘
â•‘   â”‚   - agent_scratchpad æ ¼å¼åŒ–æ‰§è¡Œå†å²ä¸ºæ–‡æœ¬                                   â”‚     â•‘
â•‘   â”‚   - AgentExecutor é©±åŠ¨å¾ªç¯                                                  â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   çŠ¶æ€ç®¡ç†ï¼š                                                                â”‚     â•‘
â•‘   â”‚   intermediate_steps: list[tuple[AgentAction, str]]                        â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                      â†“                                               â•‘
â•‘   é˜¶æ®µ 2ï¼šLangGraph æ—¶ä»£                                                             â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   ç‰¹ç‚¹ï¼š                                                                    â”‚     â•‘
â•‘   â”‚   - åŸºäºçŠ¶æ€å›¾ (StateGraph)                                                 â”‚     â•‘
â•‘   â”‚   - åŸç”Ÿ function calling / tool calling                                   â”‚     â•‘
â•‘   â”‚   - æ˜¾å¼çš„èŠ‚ç‚¹å’Œè¾¹                                                          â”‚     â•‘
â•‘   â”‚   - Checkpointer æŒä¹…åŒ–                                                     â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                      â†“                                               â•‘
â•‘   é˜¶æ®µ 3ï¼šLangChain v1 (å½“å‰)                                                        â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   ç‰¹ç‚¹ï¼š                                                                    â”‚     â•‘
â•‘   â”‚   - ä¸­é—´ä»¶ç³»ç»Ÿ (Middleware)                                                 â”‚     â•‘
â•‘   â”‚   - å¯æ‰©å±•çš„çŠ¶æ€ Schema                                                     â”‚     â•‘
â•‘   â”‚   - create_agent ä¸€ç«™å¼åˆ›å»º                                                 â”‚     â•‘
â•‘   â”‚   - Todo ä¸­é—´ä»¶ç­‰å¢å¼ºèƒ½åŠ›                                                   â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   çŠ¶æ€ç®¡ç†ï¼š                                                                â”‚     â•‘
â•‘   â”‚   state = {messages, todos, structured_response, ...}                      â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                                                                      â•‘
â•‘   æ ¸å¿ƒï¼šä¸‰ä¸ªé˜¶æ®µéƒ½æ˜¯ ReAct æ€ç»´æ¨¡å¼ï¼Œåªæ˜¯å®ç°æ–¹å¼ä¸åŒ                                  â•‘
â•‘                                                                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## äºŒã€LangChain Classic ReAct å®ç°è¯¦è§£

åŸºäº [langchain_classic.agents](https://github.com/langchain-ai/langchain/tree/master/libs/langchain/langchain_classic/agents) çš„å®ç°ï¼š

### 2.1 æ ¸å¿ƒæ•°æ®ç»“æ„

```python
# æ—©æœŸ ReAct çš„çŠ¶æ€ç®¡ç†

# AgentAction: è¡¨ç¤ºä¸€æ¬¡åŠ¨ä½œ
class AgentAction(NamedTuple):
    tool: str           # å·¥å…·åç§°
    tool_input: str     # å·¥å…·è¾“å…¥
    log: str            # æ¨ç†æ—¥å¿—ï¼ˆåŒ…å« Thoughtï¼‰

# intermediate_steps: å­˜å‚¨æ‰§è¡Œå†å²
intermediate_steps: list[tuple[AgentAction, str]]
# æ¯ä¸ªå…ƒç´ æ˜¯ (åŠ¨ä½œ, è§‚å¯Ÿç»“æœ) çš„å…ƒç»„

# ç¤ºä¾‹
intermediate_steps = [
    (AgentAction(tool="create_file", tool_input='{"filename": "login.tsx"}', log="Thought: éœ€è¦å…ˆåˆ›å»º..."), 
     "æ–‡ä»¶ login.tsx å·²åˆ›å»º"),
    (AgentAction(tool="create_file", tool_input='{"filename": "register.tsx"}', log="Thought: ç°åœ¨åˆ›å»º..."), 
     "æ–‡ä»¶ register.tsx å·²åˆ›å»º"),
]
```

### 2.2 create_react_agent çš„æ ¸å¿ƒæµç¨‹

```python
# ç®€åŒ–ç‰ˆçš„ create_react_agent å®ç°

def create_react_agent(llm, tools, prompt, output_parser, ...):
    return (
        # 1. å°† intermediate_steps æ ¼å¼åŒ–ä¸º agent_scratchpad
        RunnablePassthrough.assign(
            agent_scratchpad=lambda x: format_log_to_str(x["intermediate_steps"]),
        )
        # 2. å¡«å……æç¤ºè¯æ¨¡æ¿
        | prompt
        # 3. è°ƒç”¨æ¨¡å‹
        | llm_with_stop
        # 4. è§£æè¾“å‡º
        | output_parser
    )
```

### 2.3 format_log_to_str çš„ä½œç”¨

```python
def format_log_to_str(intermediate_steps):
    """å°†ç»“æ„åŒ–çš„æ‰§è¡Œå†å²æ ¼å¼åŒ–ä¸ºæ–‡æœ¬"""
    log_string = ""
    for action, observation in intermediate_steps:
        # action.log åŒ…å« "Thought: ..." å’Œ "Action: ..."
        log_string += action.log
        log_string += f"\nObservation: {observation}\nThought: "
    return log_string
```

---

## ä¸‰ã€Classic ReAct å¤„ç† Todo ä»»åŠ¡çš„è¯¦ç»†æµç¨‹

ä»»åŠ¡ï¼š"å¸®æˆ‘åˆ›å»º login.tsx å’Œ register.tsx ä¸¤ä¸ªæ–‡ä»¶"

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                      â•‘
â•‘            LangChain Classic ReAct å¤„ç† Todo ä»»åŠ¡çš„è¯¦ç»†æµç¨‹                            â•‘
â•‘                                                                                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                                      â•‘
â•‘   åˆå§‹çŠ¶æ€ï¼š                                                                          â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘   â”‚                                                                                â”‚ â•‘
â•‘   â”‚  state = {                                                                     â”‚ â•‘
â•‘   â”‚      "input": "å¸®æˆ‘åˆ›å»º login.tsx å’Œ register.tsx ä¸¤ä¸ªæ–‡ä»¶",                    â”‚ â•‘
â•‘   â”‚      "intermediate_steps": [],   â† ç»“æ„åŒ–çŠ¶æ€ï¼Œåˆå§‹ä¸ºç©º                         â”‚ â•‘
â•‘   â”‚      "chat_history": ""          â† å¯é€‰çš„å¯¹è¯å†å²                               â”‚ â•‘
â•‘   â”‚  }                                                                             â”‚ â•‘
â•‘   â”‚                                                                                â”‚ â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                                      â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â•‘
â•‘   â•‘                          ç¬¬ 1 è½®æ¨¡å‹è°ƒç”¨                                    â•‘   â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ“ Step 1: format_log_to_str(intermediate_steps)                                â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  intermediate_steps = []                                                   â”‚  â•‘
â•‘   â”‚  â”‚  agent_scratchpad = ""   â† ç©ºçš„ï¼Œå› ä¸ºè¿˜æ²¡æœ‰æ‰§è¡Œå†å²                         â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ“ Step 2: å¡«å……æç¤ºè¯æ¨¡æ¿                                                       â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  å¡«å……åçš„æç¤ºè¯ï¼š                                                           â”‚  â•‘
â•‘   â”‚  â”‚  """                                                                       â”‚  â•‘
â•‘   â”‚  â”‚  Answer the following questions as best you can.                           â”‚  â•‘
â•‘   â”‚  â”‚  You have access to the following tools:                                   â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  create_file: Create a file with given content                             â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  Use the following format:                                                 â”‚  â•‘
â•‘   â”‚  â”‚  Question: the input question you must answer                              â”‚  â•‘
â•‘   â”‚  â”‚  Thought: you should always think about what to do                         â”‚  â•‘
â•‘   â”‚  â”‚  Action: the action to take, should be one of [create_file]                â”‚  â•‘
â•‘   â”‚  â”‚  Action Input: the input to the action                                     â”‚  â•‘
â•‘   â”‚  â”‚  Observation: the result of the action                                     â”‚  â•‘
â•‘   â”‚  â”‚  ... (this Thought/Action/Action Input/Observation can repeat N times)     â”‚  â•‘
â•‘   â”‚  â”‚  Thought: I now know the final answer                                      â”‚  â•‘
â•‘   â”‚  â”‚  Final Answer: the final answer                                            â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  Begin!                                                                    â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  Question: å¸®æˆ‘åˆ›å»º login.tsx å’Œ register.tsx ä¸¤ä¸ªæ–‡ä»¶                      â”‚  â•‘
â•‘   â”‚  â”‚  Thought: {agent_scratchpad}                                               â”‚  â•‘
â•‘   â”‚  â”‚  """                                                                       â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  ç”±äº agent_scratchpad ä¸ºç©ºï¼Œæç¤ºè¯ä»¥ "Thought: " ç»“å°¾                      â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ“¤ Step 3: å‘é€ç»™æ¨¡å‹                                                           â•‘
â•‘   â”‚  ï¼ˆæ¨¡å‹çœ‹åˆ°æç¤ºè¯ï¼Œç»§ç»­ç”Ÿæˆï¼‰                                                     â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ“¥ Step 4: æ¨¡å‹è¿”å›ï¼ˆæ–‡æœ¬æ ¼å¼ï¼‰                                                  â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  æ¨¡å‹ç”Ÿæˆçš„æ–‡æœ¬ï¼š                                                           â”‚  â•‘
â•‘   â”‚  â”‚  "éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ã€‚æˆ‘å…ˆåˆ›å»º login.tsxã€‚                                    â”‚  â•‘
â•‘   â”‚  â”‚   Action: create_file                                                      â”‚  â•‘
â•‘   â”‚  â”‚   Action Input: {"filename": "login.tsx", "content": "..."}"               â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  âš ï¸ æ¨¡å‹åœ¨ "Observation" å‰åœæ­¢ï¼ˆå› ä¸ºè®¾ç½®äº† stop=["\nObservation"]ï¼‰        â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ“ Step 5: OutputParser è§£æ                                                    â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  ReActSingleInputOutputParser è§£æå‡ºï¼š                                      â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  AgentAction(                                                              â”‚  â•‘
â•‘   â”‚  â”‚      tool="create_file",                                                   â”‚  â•‘
â•‘   â”‚  â”‚      tool_input='{"filename": "login.tsx", "content": "..."}',             â”‚  â•‘
â•‘   â”‚  â”‚      log="éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ã€‚æˆ‘å…ˆåˆ›å»º login.tsxã€‚\nAction: create_file..."   â”‚  â•‘
â•‘   â”‚  â”‚  )                                                                         â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  âœ… è§£æå™¨ä»æ–‡æœ¬ä¸­æå–ç»“æ„åŒ–çš„ AgentAction                                  â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ”§ Step 6: AgentExecutor æ‰§è¡Œå·¥å…·                                               â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  result = create_file(filename="login.tsx", content="...")                 â”‚  â•‘
â•‘   â”‚  â”‚  observation = "æ–‡ä»¶ login.tsx å·²åˆ›å»º"                                     â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ“ Step 7: æ›´æ–° intermediate_steps                                              â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  intermediate_steps.append((agent_action, observation))                    â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  intermediate_steps = [                                                    â”‚  â•‘
â•‘   â”‚  â”‚      (                                                                     â”‚  â•‘
â•‘   â”‚  â”‚          AgentAction(tool="create_file", tool_input="...",                 â”‚  â•‘
â•‘   â”‚  â”‚                      log="éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶..."),                            â”‚  â•‘
â•‘   â”‚  â”‚          "æ–‡ä»¶ login.tsx å·²åˆ›å»º"                                           â”‚  â•‘
â•‘   â”‚  â”‚      )                                                                     â”‚  â•‘
â•‘   â”‚  â”‚  ]                                                                         â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  âœ… ç»“æ„åŒ–çŠ¶æ€å·²æ›´æ–°ï¼ä¸åªæ˜¯ messages                                       â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â•‘
â•‘                                                                                      â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â•‘
â•‘   â•‘                          ç¬¬ 2 è½®æ¨¡å‹è°ƒç”¨                                    â•‘   â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ“ Step 1: format_log_to_str(intermediate_steps)                                â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  agent_scratchpad = format_log_to_str(intermediate_steps)                  â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  ç”Ÿæˆçš„æ–‡æœ¬ï¼š                                                               â”‚  â•‘
â•‘   â”‚  â”‚  "éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ã€‚æˆ‘å…ˆåˆ›å»º login.tsxã€‚                                    â”‚  â•‘
â•‘   â”‚  â”‚   Action: create_file                                                      â”‚  â•‘
â•‘   â”‚  â”‚   Action Input: {"filename": "login.tsx", "content": "..."}                â”‚  â•‘
â•‘   â”‚  â”‚   Observation: æ–‡ä»¶ login.tsx å·²åˆ›å»º                                       â”‚  â•‘
â•‘   â”‚  â”‚   Thought: "                                                               â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  âœ… ä»ç»“æ„åŒ–çŠ¶æ€æ ¼å¼åŒ–ä¸ºæ–‡æœ¬                                                â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ“ Step 2: å¡«å……æç¤ºè¯æ¨¡æ¿                                                       â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  å¡«å……åçš„æç¤ºè¯ï¼ˆåªå±•ç¤ºå˜åŒ–éƒ¨åˆ†ï¼‰ï¼š                                          â”‚  â•‘
â•‘   â”‚  â”‚  """                                                                       â”‚  â•‘
â•‘   â”‚  â”‚  ...                                                                       â”‚  â•‘
â•‘   â”‚  â”‚  Question: å¸®æˆ‘åˆ›å»º login.tsx å’Œ register.tsx ä¸¤ä¸ªæ–‡ä»¶                      â”‚  â•‘
â•‘   â”‚  â”‚  Thought: éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶ã€‚æˆ‘å…ˆåˆ›å»º login.tsxã€‚                            â”‚  â•‘
â•‘   â”‚  â”‚  Action: create_file                                                       â”‚  â•‘
â•‘   â”‚  â”‚  Action Input: {"filename": "login.tsx", "content": "..."}                 â”‚  â•‘
â•‘   â”‚  â”‚  Observation: æ–‡ä»¶ login.tsx å·²åˆ›å»º                                        â”‚  â•‘
â•‘   â”‚  â”‚  Thought:                                                                  â”‚  â•‘
â•‘   â”‚  â”‚  """                                                                       â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  âœ… æ‰§è¡Œå†å²è¢«æ ¼å¼åŒ–åˆ°æç¤ºè¯ä¸­                                              â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ“¥ æ¨¡å‹è¿”å›ï¼š                                                                   â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  "login.tsx å·²ç»åˆ›å»ºå¥½äº†ã€‚ç°åœ¨åˆ›å»º register.tsxã€‚                           â”‚  â•‘
â•‘   â”‚  â”‚   Action: create_file                                                      â”‚  â•‘
â•‘   â”‚  â”‚   Action Input: {"filename": "register.tsx", "content": "..."}"            â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ”§ æ‰§è¡Œå·¥å…·ï¼Œæ›´æ–° intermediate_steps                                            â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  intermediate_steps = [                                                    â”‚  â•‘
â•‘   â”‚  â”‚      (AgentAction(...login.tsx...), "æ–‡ä»¶ login.tsx å·²åˆ›å»º"),              â”‚  â•‘
â•‘   â”‚  â”‚      (AgentAction(...register.tsx...), "æ–‡ä»¶ register.tsx å·²åˆ›å»º")  â† æ–°å¢ â”‚  â•‘
â•‘   â”‚  â”‚  ]                                                                         â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â•‘
â•‘                                                                                      â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â•‘
â•‘   â•‘                          ç¬¬ 3 è½®æ¨¡å‹è°ƒç”¨                                    â•‘   â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ“¥ æ¨¡å‹è¿”å›ï¼š                                                                   â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  "ä¸¤ä¸ªæ–‡ä»¶éƒ½å·²ç»åˆ›å»ºå®Œæˆã€‚                                                  â”‚  â•‘
â•‘   â”‚  â”‚   Final Answer: æˆ‘å·²ç»å¸®ä½ åˆ›å»ºäº† login.tsx å’Œ register.tsx ä¸¤ä¸ªæ–‡ä»¶"        â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  âœ… æ¨¡å‹è¾“å‡º "Final Answer"ï¼Œè§£æå™¨è¿”å› AgentFinish                         â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â”‚  ğŸ“ OutputParser è§£æä¸º AgentFinish                                              â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  AgentFinish(                                                              â”‚  â•‘
â•‘   â”‚  â”‚      return_values={"output": "æˆ‘å·²ç»å¸®ä½ åˆ›å»ºäº†..."},                       â”‚  â•‘
â•‘   â”‚  â”‚      log="ä¸¤ä¸ªæ–‡ä»¶éƒ½å·²ç»åˆ›å»ºå®Œæˆã€‚\nFinal Answer: ..."                      â”‚  â•‘
â•‘   â”‚  â”‚  )                                                                         â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â”‚  âœ… AgentExecutor æ£€æµ‹åˆ° AgentFinishï¼Œç»“æŸå¾ªç¯                              â”‚  â•‘
â•‘   â”‚  â”‚                                                                            â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘   â”‚                                                                                  â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â•‘
â•‘                                                                                      â•‘
â•‘   æœ€ç»ˆçŠ¶æ€ï¼š                                                                          â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘   â”‚                                                                                â”‚ â•‘
â•‘   â”‚  state = {                                                                     â”‚ â•‘
â•‘   â”‚      "input": "å¸®æˆ‘åˆ›å»º login.tsx å’Œ register.tsx ä¸¤ä¸ªæ–‡ä»¶",                    â”‚ â•‘
â•‘   â”‚      "intermediate_steps": [                     â† ç»“æ„åŒ–çš„æ‰§è¡Œå†å²            â”‚ â•‘
â•‘   â”‚          (AgentAction(...login.tsx...), "æ–‡ä»¶ login.tsx å·²åˆ›å»º"),              â”‚ â•‘
â•‘   â”‚          (AgentAction(...register.tsx...), "æ–‡ä»¶ register.tsx å·²åˆ›å»º"),        â”‚ â•‘
â•‘   â”‚      ],                                                                        â”‚ â•‘
â•‘   â”‚      "output": "æˆ‘å·²ç»å¸®ä½ åˆ›å»ºäº† login.tsx å’Œ register.tsx ä¸¤ä¸ªæ–‡ä»¶"            â”‚ â•‘
â•‘   â”‚  }                                                                             â”‚ â•‘
â•‘   â”‚                                                                                â”‚ â•‘
â•‘   â”‚  âœ… Classic ReAct ä¹Ÿæœ‰ç»“æ„åŒ–çŠ¶æ€ç®¡ç†ï¼ˆintermediate_stepsï¼‰                       â”‚ â•‘
â•‘   â”‚  âœ… åªæ˜¯æ ¼å¼åŒ–ä¸ºæ–‡æœ¬åä¼ ç»™æ¨¡å‹                                                  â”‚ â•‘
â•‘   â”‚                                                                                â”‚ â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## å››ã€LangChain v1 çš„æ¼”è¿›ï¼šä» intermediate_steps åˆ° messages

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                      â•‘
â•‘                    çŠ¶æ€ç®¡ç†æ¼”è¿›å¯¹æ¯”                                                   â•‘
â•‘                                                                                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                                      â•‘
â•‘   LangChain Classic:                                                                 â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   çŠ¶æ€ï¼šintermediate_steps: list[tuple[AgentAction, str]]                  â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   ä¼ ç»™æ¨¡å‹ï¼šformat_log_to_str(intermediate_steps) â†’ çº¯æ–‡æœ¬                  â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   æ¨¡å‹è¾“å…¥ï¼šå•ä¸ª prompt å­—ç¬¦ä¸²ï¼ˆåŒ…å«æ ¼å¼åŒ–çš„å†å²ï¼‰                           â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â•‘
â•‘   â”‚   â”‚ prompt = """                                                       â”‚  â”‚     â•‘
â•‘   â”‚   â”‚ ...å·¥å…·æè¿°...                                                      â”‚  â”‚     â•‘
â•‘   â”‚   â”‚ Question: {input}                                                  â”‚  â”‚     â•‘
â•‘   â”‚   â”‚ Thought: éœ€è¦åˆ›å»ºä¸¤ä¸ªæ–‡ä»¶...                                        â”‚  â”‚     â•‘
â•‘   â”‚   â”‚ Action: create_file                                                â”‚  â”‚     â•‘
â•‘   â”‚   â”‚ Action Input: {...}                                                â”‚  â”‚     â•‘
â•‘   â”‚   â”‚ Observation: æ–‡ä»¶å·²åˆ›å»º                                             â”‚  â”‚     â•‘
â•‘   â”‚   â”‚ Thought:                                                           â”‚  â”‚     â•‘
â•‘   â”‚   â”‚ """                                                                â”‚  â”‚     â•‘
â•‘   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                      â†“                                               â•‘
â•‘   LangChain v1 (åŸºäº LangGraph):                                                     â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   çŠ¶æ€ï¼šstate = {                                                          â”‚     â•‘
â•‘   â”‚       "messages": list[AnyMessage],  â† ç›´æ¥ç”¨æ¶ˆæ¯å¯¹è±¡                       â”‚     â•‘
â•‘   â”‚       "todos": list[Todo],           â† ä¸­é—´ä»¶å¯æ‰©å±•çŠ¶æ€                     â”‚     â•‘
â•‘   â”‚       ...                                                                  â”‚     â•‘
â•‘   â”‚   }                                                                        â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   ä¼ ç»™æ¨¡å‹ï¼šmessages åˆ—è¡¨ï¼ˆåŸç”Ÿå¯¹è¯æ ¼å¼ï¼‰                                    â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   æ¨¡å‹è¾“å…¥ï¼šå¤šè½®å¯¹è¯æ¶ˆæ¯åˆ—è¡¨                                                 â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â•‘
â•‘   â”‚   â”‚ messages = [                                                       â”‚  â”‚     â•‘
â•‘   â”‚   â”‚     SystemMessage("..."),                                          â”‚  â”‚     â•‘
â•‘   â”‚   â”‚     HumanMessage("å¸®æˆ‘åˆ›å»º..."),                                    â”‚  â”‚     â•‘
â•‘   â”‚   â”‚     AIMessage(tool_calls=[...]),                                   â”‚  â”‚     â•‘
â•‘   â”‚   â”‚     ToolMessage("æ–‡ä»¶å·²åˆ›å»º"),                                      â”‚  â”‚     â•‘
â•‘   â”‚   â”‚     AIMessage(tool_calls=[...]),                                   â”‚  â”‚     â•‘
â•‘   â”‚   â”‚     ToolMessage("æ–‡ä»¶å·²åˆ›å»º"),                                      â”‚  â”‚     â•‘
â•‘   â”‚   â”‚ ]                                                                  â”‚  â”‚     â•‘
â•‘   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                                                                      â•‘
â•‘   å…³é”®åŒºåˆ«ï¼š                                                                          â•‘
â•‘   1. Classic: ç»“æ„åŒ–çŠ¶æ€ â†’ æ ¼å¼åŒ–ä¸ºæ–‡æœ¬ â†’ å•ä¸ª prompt                                â•‘
â•‘   2. v1: æ¶ˆæ¯åˆ—è¡¨ â†’ ç›´æ¥ä¼ ç»™æ¨¡å‹ï¼ˆåŸç”Ÿå¤šè½®å¯¹è¯ï¼‰                                      â•‘
â•‘                                                                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## äº”ã€Todo ä¸­é—´ä»¶çš„å¢å¼ºï¼šåœ¨ v1 åŸºç¡€ä¸Šæ·»åŠ è§„åˆ’èƒ½åŠ›

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                      â•‘
â•‘                    Todo ä¸­é—´ä»¶ï¼šå¢åŠ è§„åˆ’å±‚                                            â•‘
â•‘                                                                                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                                      â•‘
â•‘   ä¸åŒé˜¶æ®µçš„ ReAct å¯¹"ä»»åŠ¡è§„åˆ’"çš„æ”¯æŒï¼š                                               â•‘
â•‘                                                                                      â•‘
â•‘   Classic ReAct:                                                                     â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   - intermediate_steps è®°å½•ã€å·²æ‰§è¡Œã€‘çš„åŠ¨ä½œ                                 â”‚     â•‘
â•‘   â”‚   - æ²¡æœ‰ã€å¾…æ‰§è¡Œã€‘ä»»åŠ¡åˆ—è¡¨                                                  â”‚     â•‘
â•‘   â”‚   - æ¨¡å‹éœ€è¦ä»å¯¹è¯å†å²æ¨æ–­è¿˜æœ‰ä»€ä¹ˆæ²¡åš                                       â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   çŠ¶æ€ï¼š                                                                    â”‚     â•‘
â•‘   â”‚   intermediate_steps = [                                                   â”‚     â•‘
â•‘   â”‚       (å·²å®Œæˆçš„åŠ¨ä½œ1, ç»“æœ1),                                              â”‚     â•‘
â•‘   â”‚       (å·²å®Œæˆçš„åŠ¨ä½œ2, ç»“æœ2),                                              â”‚     â•‘
â•‘   â”‚   ]                                                                        â”‚     â•‘
â•‘   â”‚   # æ²¡æœ‰"å¾…åŠåˆ—è¡¨"                                                         â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                                                                      â•‘
â•‘   LangChain v1ï¼ˆæ—  Todo ä¸­é—´ä»¶ï¼‰:                                                     â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   - messages è®°å½•å®Œæ•´å¯¹è¯å†å²                                               â”‚     â•‘
â•‘   â”‚   - åŒæ ·æ²¡æœ‰æ˜¾å¼çš„ä»»åŠ¡åˆ—è¡¨                                                  â”‚     â•‘
â•‘   â”‚   - æ¨¡å‹ä» messages æ¨æ–­ä»»åŠ¡è¿›åº¦                                            â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   çŠ¶æ€ï¼š                                                                    â”‚     â•‘
â•‘   â”‚   state = {"messages": [...]}                                              â”‚     â•‘
â•‘   â”‚   # æ²¡æœ‰"å¾…åŠåˆ—è¡¨"                                                         â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                                                                      â•‘
â•‘   LangChain v1 + Todo ä¸­é—´ä»¶:                                                        â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   - messages è®°å½•å®Œæ•´å¯¹è¯å†å²                                               â”‚     â•‘
â•‘   â”‚   - todos è®°å½•ã€æ˜¾å¼çš„ä»»åŠ¡åˆ—è¡¨å’ŒçŠ¶æ€ã€‘                                       â”‚     â•‘
â•‘   â”‚   - ä»»åŠ¡çŠ¶æ€å¯æŒä¹…åŒ–ã€å¯æ¢å¤ã€ç”¨æˆ·å¯è§                                       â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â”‚   çŠ¶æ€ï¼š                                                                    â”‚     â•‘
â•‘   â”‚   state = {                                                                â”‚     â•‘
â•‘   â”‚       "messages": [...],                                                   â”‚     â•‘
â•‘   â”‚       "todos": [                         â† æ˜¾å¼çš„ä»»åŠ¡åˆ—è¡¨ï¼                  â”‚     â•‘
â•‘   â”‚           {"content": "åˆ›å»º login.tsx", "status": "completed"},            â”‚     â•‘
â•‘   â”‚           {"content": "åˆ›å»º register.tsx", "status": "in_progress"},       â”‚     â•‘
â•‘   â”‚       ]                                                                    â”‚     â•‘
â•‘   â”‚   }                                                                        â”‚     â•‘
â•‘   â”‚                                                                            â”‚     â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â•‘
â•‘                                                                                      â•‘
â•‘   Todo ä¸­é—´ä»¶çš„å¢å¼ºï¼š                                                                 â•‘
â•‘   1. write_todos å·¥å…·ï¼šè®©æ¨¡å‹å¯ä»¥åˆ›å»ºå’Œæ›´æ–°ä»»åŠ¡åˆ—è¡¨                                   â•‘
â•‘   2. todos çŠ¶æ€ï¼šç‹¬ç«‹äº messages çš„ç»“æ„åŒ–ä»»åŠ¡çŠ¶æ€                                     â•‘
â•‘   3. ç³»ç»Ÿæç¤ºè¯ï¼šå¼•å¯¼æ¨¡å‹åœ¨å¤æ‚ä»»åŠ¡æ—¶å…ˆè§„åˆ’                                           â•‘
â•‘                                                                                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## å…­ã€ä¸‰ç§å®ç°çš„è®°å¿†ç®¡ç†å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ç»´åº¦              â”‚     LangChain Classic           â”‚      LangChain v1               â”‚    v1 + Todo ä¸­é—´ä»¶              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”‚  æ˜¯å¦ ReActï¼Ÿ              â”‚  âœ… æ˜¯                           â”‚  âœ… æ˜¯                           â”‚  âœ… æ˜¯ï¼ˆå¢å¼ºç‰ˆï¼‰                 â”‚
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”‚  æ ¸å¿ƒçŠ¶æ€                   â”‚  intermediate_steps             â”‚  messages                       â”‚  messages + todos               â”‚
â”‚                            â”‚  list[(AgentAction, str)]       â”‚  list[AnyMessage]               â”‚  + å¯æ‰©å±•çŠ¶æ€                    â”‚
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”‚  ä¼ ç»™æ¨¡å‹çš„æ ¼å¼             â”‚  æ ¼å¼åŒ–ä¸ºæ–‡æœ¬ (prompt)           â”‚  æ¶ˆæ¯åˆ—è¡¨ (åŸç”Ÿå¤šè½®)             â”‚  æ¶ˆæ¯åˆ—è¡¨ (åŸç”Ÿå¤šè½®)             â”‚
â”‚                            â”‚  agent_scratchpad               â”‚  ç›´æ¥ä¼  messages                â”‚  ç›´æ¥ä¼  messages                â”‚
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”‚  ä»»åŠ¡åˆ—è¡¨                   â”‚  âŒ æ—                            â”‚  âŒ æ—                            â”‚  âœ… todos çŠ¶æ€                   â”‚
â”‚                            â”‚  åªæœ‰å·²æ‰§è¡ŒåŠ¨ä½œ                  â”‚  åªæœ‰å¯¹è¯å†å²                    â”‚  æ˜¾å¼çš„å¾…åŠäº‹é¡¹                  â”‚
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”‚  æŒä¹…åŒ–                     â”‚  éœ€è¦è‡ªå·±å®ç°                    â”‚  âœ… Checkpointer                â”‚  âœ… Checkpointer                â”‚
â”‚                            â”‚                                 â”‚  è‡ªåŠ¨ä¿å­˜ messages              â”‚  ä¿å­˜ messages + todos          â”‚
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”‚  ç”¨æˆ·å¯è§æ€§                 â”‚  âŒ éœ€è¦è§£æ                     â”‚  âŒ éœ€è¦è§£æ                     â”‚  âœ… todos å¯ç›´æ¥å±•ç¤º             â”‚
â”‚                            â”‚  ä» agent_scratchpad            â”‚  ä» messages                    â”‚                                 â”‚
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â”‚  å·¥å…·è°ƒç”¨å®ç°               â”‚  æ–‡æœ¬è§£æ (OutputParser)         â”‚  åŸç”Ÿ function calling          â”‚  åŸç”Ÿ function calling          â”‚
â”‚                            â”‚  Action: ... / Action Input:    â”‚  model.bind_tools()             â”‚  model.bind_tools()             â”‚
â”‚                            â”‚                                 â”‚                                 â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸ƒã€æ€»ç»“

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                                     â”‚
â”‚                              æ ¸å¿ƒç†è§£                                                â”‚
â”‚                                                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                     â”‚
â”‚   1. ReAct æ˜¯æ€ç»´æ¨¡å¼ï¼Œä¸æ˜¯å…·ä½“å®ç°                                                  â”‚
â”‚      - Classicã€v1ã€v1+Todo éƒ½æ˜¯ ReAct                                              â”‚
â”‚      - æ ¸å¿ƒå¾ªç¯ï¼šæ¨ç† â†’ è¡ŒåŠ¨ â†’ è§‚å¯Ÿ â†’ å¾ªç¯                                           â”‚
â”‚                                                                                     â”‚
â”‚   2. æ—©æœŸ LangChain ä¹Ÿæœ‰çŠ¶æ€ç®¡ç†                                                     â”‚
â”‚      - intermediate_steps æ˜¯ç»“æ„åŒ–çš„ (AgentAction, observation) åˆ—è¡¨                â”‚
â”‚      - ä¸æ˜¯ç®€å•åœ°æŠŠå†å²å †åœ¨æ–‡æœ¬é‡Œ                                                    â”‚
â”‚      - åªæ˜¯æ ¼å¼åŒ–ä¸ºæ–‡æœ¬åä¼ ç»™æ¨¡å‹                                                    â”‚
â”‚                                                                                     â”‚
â”‚   3. æ¼”è¿›æ–¹å‘                                                                        â”‚
â”‚      - Classic: ç»“æ„åŒ–çŠ¶æ€ â†’ æ ¼å¼åŒ–ä¸ºæ–‡æœ¬ â†’ å•ä¸ª prompt                              â”‚
â”‚      - v1: æ¶ˆæ¯åˆ—è¡¨ â†’ åŸç”Ÿå¤šè½®å¯¹è¯ + å¯æ‰©å±•çŠ¶æ€                                       â”‚
â”‚      - v1+Todo: å¢åŠ æ˜¾å¼çš„ä»»åŠ¡è§„åˆ’å±‚                                                 â”‚
â”‚                                                                                     â”‚
â”‚   4. Todo ä¸­é—´ä»¶çš„ä»·å€¼                                                               â”‚
â”‚      - ä¸æ˜¯æ›¿ä»£ ReActï¼Œè€Œæ˜¯å¢å¼º ReAct                                                â”‚
â”‚      - å¢åŠ äº†æ˜¾å¼çš„ä»»åŠ¡åˆ—è¡¨ï¼ˆtodos çŠ¶æ€ï¼‰                                            â”‚
â”‚      - è®©ä»»åŠ¡è¿›åº¦ç”¨æˆ·å¯è§ã€å¯æŒä¹…åŒ–                                                  â”‚
â”‚                                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

